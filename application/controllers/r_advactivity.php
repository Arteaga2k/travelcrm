<?php/** * TravelCRM * * An open source CRM system for travel agencies * * @author		Mazvv (vitalii.mazur@gmail.com) * @license		GNU GPLv3 (http://gplv3.fsf.org)  * @link		http://www.travelcrm.org.ua */include_once APPPATH."libraries/core/Reportcontroller.php";class R_advactivity extends Reportcontroller {	public function __construct(){		parent::__construct();		$this->lang->load('r_advactivity');		$this->load->model('r_advactivity_model');		$this->load->helper('filials');		$this->load->helper('advertisescompanies');			}	public function _remap($m_Name){		switch ($m_Name) {			default: $this->create();		}	}	private function create(){		$data = array();		$data['title'] = lang('R_ADVACTIVITY_TITLE');		$data['orid'] = $this->get_orid();		$this->set_validation();		if ($this->form_validation->run() === True){			$data['report'] = True;			$data['ds'] = $this->r_advactivity_model->get_ds();			if(!$data['ds']){				$data['report'] = False;				$data['report_error'] = lang('REPORT_ERROR');			}			$data['by_slice'] = $this->input->post('by_slice');			$data['r_body_title'] = sprintf(lang('R_BODY_TITLE'), $this->input->post('date_report_from'),											$this->input->post('date_report_to'),											(($this->input->post('by_slice')=='type')?lang('BY_TYPES'):lang('BY_NAME')),											($this->input->post('_filials_rid')?get_filial_name_byrid($this->input->post('_filials_rid')):lang('R_ALL')));   		}		$data['content'] = $this->load->view('reports/r_advactivity/create', $data, True);		return $this->load->view('layouts/main_layout', $data);	}	private function set_validation(){		$this->form_validation->set_rules('date_report_from', lang('DATE_REPORT_FROM'), 'required|trim');		$this->form_validation->set_rules('date_report_to', lang('DATE_REPORT_TO'), 'required|trim');		$this->form_validation->set_rules('_filials_rid', lang('FILIAL'), 'trim');		$this->form_validation->set_rules('_advertisescompanies_rid', lang('ADV_COMPANY'), 'trim');		return;	}}?>